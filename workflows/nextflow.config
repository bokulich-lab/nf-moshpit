params {
  condaEnvPath = ""
  imageTag = ""
  email = ""
  executor = ""
  storeDir = ""
  traceDir = ""
  tempDir = "$SCRATCH/tmp"
  cacheLocation = ""
  qiime2CacheDir = ""
  additionalRunOptionsSingularity = "-B $WORK/tmp:/tmp -B $WORK -H $SCRATCH/tmp_home:/home/qiime2 -B $HOME:$HOME"
  additionalRunOptionsDocker = ""
  inputReads = ""

  fondue {
    cpus = 1
    storeDir = ""
    paired = true
    filesAccessionIds = ""
    time = 4.h
  }

  read_qc {
    n_reads = 10000
    time = 4.h
    storeDir = ""
  }

  read_trimming {
    enabled = false
    storeDir = ""
    paired = true
    adapter_f = ""
    front_f = ""
    anywhere_f = ""
    adapter_r = ""
    front_r = ""
    anywhere_r = ""
    error_rate = 0.1
    indels = true
    times = 1
    overlap = 3
    match_read_wildcards = false
    match_adapter_wildcards = true
    minimum_length = 1
    discard_untrimmed = false
    max_expected_errors = 0
    max_n = 0
    quality_cutoff_5end = 0
    quality_cutoff_3end = 0
    quality_base = 33
    cpus = 1
    time = 4.h
  }

  host_removal {
    enabled = false
    storeDir = ""
    cpus = 1
    time = 4.h
    database = ""
    mode = "local"
    sensitivity = "sensitive"
    ref_gap_open_penalty = 5
    ref_gap_ext_penalty = 3
    exclude_seqs = true
  }

  read_simulation {
    cpus = 1
    storeDir = ""
    sampleCount = 1
    nGenomes = 2
    readCount = 200000
    sampleGenomes = ""
    sampleNames = (1..params.read_simulation.sampleCount).toList().collect { i -> "sample${i}"}.join(' ')
    taxon = ""
    time = 4.h
  }

  read_subsampling {
    enabled = false
    storeDir = ""
    paired = true
    time = 2.h
    fraction = 0.2
  }

  genome_assembly {
    enable = false
    storeDir = ""
    cpus = 1
    assembler = "megahit"
    time = 4.h
    clusterOptions = '--mem-per-cpu=3G'
    megahit {
      presets = "meta-sensitive"
      kList = "21 29 39 59 79 99 119 141"
      minContigLen = 200
      additionalFlags = ""
    }
    spades {
      k = "auto"
      debug = false
      covCutoff = "off"
      additionalFlags = "--p-meta"
    }
  }

  assembly_qc {
    enabled = false
    storeDir = ""
    useReads = false
    cpus = 1
    time = 4.h
  }

  contig_indexing {
    cpus = 1
    time = 4.h
    storeDir = ""
  }

  read_mapping {
    cpus = 1
    time = 4.h
    storeDir = ""
  }

  taxonomic_classification {
    enabled = false
    storeDir = ""
    cpus = 1
    clusterOptions = '--mem-per-cpu=128G'
    kraken2DBpath = ""
    kraken2MemoryMapping = true
    time = 4.h
  }

  binning {
    enabled = false
    cpus = 1
    time = 4.h
    storeDir = ""
  }

  binning_qc {
    enabled = false
    storeDir = ""
    cpus = 1
    clusterOptions = '--mem-per-cpu=12G'
    pplacerThreads = 1
    checkmDBpath = ""
    checkmReducedTree = true
    time = 4.h
  }

}

def timestamp = new java.util.Date().format( 'yyyyMMddHHmmss' )
trace {
    enabled = true
    file = "${params.traceDir}/${timestamp}_trace.txt"
}
timeline {
    enabled = true
    file    = "${params.traceDir}/${timestamp}_timeline.html"
}
report {
    enabled = true
    file    = "${params.traceDir}/${timestamp}_report.html"
}
dag {
    enabled = true
    file    = "${params.traceDir}/${timestamp}_dag.svg"
}

profiles {
  conda {
    process.conda = params.condaEnvPath
    if (params.executor) {
        process.executor = params.executor
    }
  }

  singularity {
    singularity.enabled = true
    singularity.autoMounts = false
    singularity.engineOptions = ""
    singularity.runOptions = "${params.additionalRunOptionsSingularity}"
    singularity.envWhitelist = "http_proxy,https_proxy,ftp_proxy"
    process.container = params.imageTag
    if (params.tempDir) {
        singularity.temp = params.tempDir
    }
    if (params.executor) {
        process.executor = params.executor
    }
  }

  docker {
    docker.enabled = true
    docker.runOptions = "-v ${params.cacheLocation}:/cache ${params.additionalRunOptionsDocker}"
    process.container = params.imageTag
    if (params.tempDir) {
        docker.temp = params.tempDir
    }
    if (params.executor) {
        process.executor = params.executor
    }
  }
}

tower {
  accessToken = ''
  endpoint = ''
  enabled = false
}